#!/bin/bash

# Attempt to reinstall all default Omarchy packages and reset all the default configs.

set -e

echo "Reinstalling missing Omarchy packages from stable repository"

# Set the package repository to the stable mirrors
omarchy-refresh-pacman

# Downgrade any packages to the stable setup
sudo pacman -Suu --noconfirm

# Ensure all packages are installed
mapfile -t packages < <(grep -v '^#' "$OMARCHY_PATH/install/omarchy-base.packages" | grep -v '^$')
sudo pacman -Syu --noconfirm --needed "${packages[@]}"
